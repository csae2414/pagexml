

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>py-pagexml: Python wrapper for the PageXML C++ library &mdash; pagexml 2021.03.15 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> pagexml
          

          
          </a>

          
            
            
              <div class="version">
                2021.03.15
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://omni-us.github.io/pageformat/pagecontent_omnius.html">OPF XSD schema documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">pagexml</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>py-pagexml: Python wrapper for the PageXML C++ library</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="py-pagexml-python-wrapper-for-the-pagexml-c-library">
<h1>py-pagexml: Python wrapper for the PageXML C++ library<a class="headerlink" href="#py-pagexml-python-wrapper-for-the-pagexml-c-library" title="Permalink to this headline">¶</a></h1>
<p>The py-pagexml python package is a library of functions that eases working with
omni:us Pages Format XML files (referred to as OPF XML files). It allows you
from python to read an OPF file, extract information contained within, modify or
add content, create an OPF from scratch, crop parts for page images, etc.</p>
<p>By default OPF XML files are validated against the XSD schema when reading,
saving, or on request by calling a function. The documentation the XSD schema
and the schema itself included in py-pagexml can be found at:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://omni-us.github.io/pageformat/pagecontent_omnius.html">XSD schema documentation</a>.</p></li>
<li><p><a class="reference external" href="https://omni-us.github.io/pageformat/pagecontent_omnius.xsd">pagecontent_omnius.xsd</a>.</p></li>
</ul>
<p>The official online documentation of py-pagexml is available at <a class="reference external" href="https://omni-us.github.io/pagexml/py-pagexml">https://omni-us.github.io/pagexml/py-pagexml</a>.</p>
<div class="section" id="software-dependencies">
<h2>Software dependencies<a class="headerlink" href="#software-dependencies" title="Permalink to this headline">¶</a></h2>
<p>The core of py-pagexml is a compiled C++ library that links with a few
libraries, so it requires installation of dependencies that cannot be
automatically obtained from pypi servers.</p>
<p>There are <a class="reference external" href="https://hub.docker.com/r/mauvilsa/pagexml/tags">docker images available at docker hub</a> which include both the
runtime and the build dependencies already installed. In particular the runtime
docker images are intended to be used as base images for applications that use
pagexml. The specific list of dependencies both for runtime and building are
listed below.</p>
<div class="section" id="runtime-dependencies">
<h3>Runtime dependencies<a class="headerlink" href="#runtime-dependencies" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>python3</p></li>
<li><p>libxml2</p></li>
<li><p>libxslt1.1</p></li>
<li><p>libopencv-imgcodecs (Ubuntu 18.04/20.04) | libopencv-highgui (Ubuntu 16.04)</p></li>
<li><p>libopencv-imgproc</p></li>
<li><p>libopencv-core</p></li>
<li><p>libgdal</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="building-dependencies">
<h3>Building dependencies<a class="headerlink" href="#building-dependencies" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>python3-setuptools</p></li>
<li><p>python3-pkgconfig</p></li>
<li><p>python3-wheel</p></li>
<li><p>python3-dev</p></li>
<li><p>swig</p></li>
<li><p>libxml2-dev</p></li>
<li><p>libxslt1-dev</p></li>
<li><p>libopencv-dev</p></li>
<li><p>libgdal-dev</p></li>
<li><p>libboost-all-dev</p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="installation-from-wheel-binary-file">
<h2>Installation from wheel binary file<a class="headerlink" href="#installation-from-wheel-binary-file" title="Permalink to this headline">¶</a></h2>
<p>If you have configured a pypi server that includes pagexml, installation is as
simple as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install pagexml<span class="o">[</span>all<span class="o">]</span>
</pre></div>
</div>
<p>Otherwise you can install it from a github <a class="reference external" href="https://github.com/omni-us/pagexml/releases">release</a>. Each release includes multiple
wheel files. One for python 3.5 which is built for Ubuntu 16.04, another for
python 3.6 built for Ubuntu 18.04 and another for python 3.8 built for Ubuntu
20.04. Once you have located the appropriate wheel file, copy the link and run
as follows replacing the URL with the one you copied:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install https://github.com/omni-us/pagexml/releases/download/20*/pagexml-20*-linux_x86_64.whl<span class="o">[</span>all<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="building-the-wheel-file-from-source">
<h2>Building the wheel file from source<a class="headerlink" href="#building-the-wheel-file-from-source" title="Permalink to this headline">¶</a></h2>
<p>Clone the github repository <a class="reference external" href="https://github.com/omni-us/pagexml.git">https://github.com/omni-us/pagexml.git</a>, go to
the py-pagexml directory and then run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install --editable .<span class="o">[</span>dev,test,all<span class="o">]</span>
./setup.py bdist_wheel
</pre></div>
</div>
</div>
<div class="section" id="simple-usage-examples">
<h2>Simple usage examples<a class="headerlink" href="#simple-usage-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-a-new-page-xml-adding-regions-text-and-properties">
<h3>Create a new Page XML adding regions, text and properties<a class="headerlink" href="#create-a-new-page-xml-adding-regions-text-and-properties" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pagexml</span>
<span class="n">pxml</span> <span class="o">=</span> <span class="n">pagexml</span><span class="o">.</span><span class="n">PageXML</span><span class="p">()</span>

<span class="c1"># Create a new page xml</span>
<span class="nb">file</span> <span class="o">=</span> <span class="s1">&#39;example_image.jpg&#39;</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">newXml</span><span class="p">(</span><span class="s1">&#39;name-and-version-of-tool&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

<span class="c1"># Add a text region to the Page</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">pxml</span><span class="o">.</span><span class="n">selectNth</span><span class="p">(</span><span class="s1">&#39;//_:Page&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">pxml</span><span class="o">.</span><span class="n">addTextRegion</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>

<span class="c1"># Set text region bounding box with a confidence</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">setCoordsBBox</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Set the text for the text region with a confidence</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">setTextEquiv</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="s1">&#39;lorem ipsum&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>

<span class="c1"># Add property to text region</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Add a second page with a text region and specific id</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">pxml</span><span class="o">.</span><span class="n">addPage</span><span class="p">(</span><span class="s1">&#39;example_image_2.jpg&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">pxml</span><span class="o">.</span><span class="n">addTextRegion</span><span class="p">(</span><span class="n">page</span><span class="p">,</span> <span class="s1">&#39;regA&#39;</span><span class="p">)</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">setCoordsBBox</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="c1"># Write XML to file</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;example_image.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="modify-an-existing-page-xml">
<h3>Modify an existing Page XML<a class="headerlink" href="#modify-an-existing-page-xml" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load an existing XML</span>
<span class="kn">import</span> <span class="nn">pagexml</span>
<span class="n">pxml</span> <span class="o">=</span> <span class="n">pagexml</span><span class="o">.</span><span class="n">PageXML</span><span class="p">(</span><span class="s1">&#39;example_image.xml&#39;</span><span class="p">)</span>

<span class="c1"># Add content to loaded XML</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="n">pxml</span><span class="o">.</span><span class="n">selectNth</span><span class="p">(</span><span class="s1">&#39;//_:Page&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Write XML to file</span>
<span class="n">pxml</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;example_image_2.xml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="crop-an-element-and-save-image-to-disk">
<h3>Crop an element and save image to disk<a class="headerlink" href="#crop-an-element-and-save-image-to-disk" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load an existing XML</span>
<span class="kn">import</span> <span class="nn">pagexml</span>
<span class="n">pxml</span> <span class="o">=</span> <span class="n">pagexml</span><span class="o">.</span><span class="n">PageXML</span><span class="p">(</span><span class="s1">&#39;examples/lorem.xml&#39;</span><span class="p">)</span>

<span class="c1"># Crop element with specific ID</span>
<span class="n">cropped</span> <span class="o">=</span> <span class="n">pxml</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="s1">&#39;//*[@id=&quot;r1_l1&quot;]/_:Coords&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Save image to disk</span>
<span class="n">pagexml</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">cropped</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">cropped</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="documentation-contents">
<h2>Documentation Contents<a class="headerlink" href="#documentation-contents" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-pagexml">pagexml module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://omni-us.github.io/pageformat/pagecontent_omnius.html">OPF XSD schema documentation</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-present, Mauricio Villegas

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>